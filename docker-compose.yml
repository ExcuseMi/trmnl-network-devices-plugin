version: "3.9"

services:
  network-scanner:
    build: .
    image: network-scanner:latest
    container_name: network-scanner

    # Critical for ARP/MAC/Wi-Fi visibility
    network_mode: host
    pid: host
    privileged: true

    restart: unless-stopped

    env_file:
      - .env

    environment:
      PLUGIN_UUID: ${PLUGIN_UUID}
      INTERVAL: ${INTERVAL}
      BYTE_LIMIT: ${BYTE_LIMIT}

    volumes:
      # Access host ARP table
      - /proc/net/arp:/host/arp:ro
      # Access DHCP leases if present
      - /var/lib/misc:/host/dhcp:ro
      - /var/lib/dhcp:/host/dhcp2:ro
